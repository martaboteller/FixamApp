<ion-app>
  <ion-header>
    <ion-toolbar color="tertiary">
      <ion-title>Detail Page</ion-title>
      <ion-buttons slot="start">
        <ion-menu-button autoHide="false"></ion-menu-button>
      </ion-buttons>
      <ion-buttons slot="end">
        <ion-icon
          style="padding-right: 5px"
          size="large"
          name="arrow-back"
          (click)="back()"
        ></ion-icon>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <ion-content>
    <form [formGroup]="detailForm">
      <ion-col>
        <ion-badge class="detailBadge" color="dark"
          >{{activeCapture.votes}}</ion-badge
        >
        <div class="container">
          <img class="detailImage" src="{{activeCapture.imageUrl}}" />
          <div class="myOverlay">
            <div class="detailDate">{{activeCapture.date | date:'short'}}</div>
            <div class="detailUser">{{getUsername(activeCapture.uid)}}</div>
          </div>
        </div>
        <!--Detail name is editable-->
        <ion-row>
          <ion-col size="4" class="detailCaptureName">
            <div *ngIf="editable; else elseBlock">
              <ion-input
                placeholder="Name"
                formControlName="captureNameEditable"
                [(ngModel)]="activeCapture.name"
              >
              </ion-input>
            </div>
            <ng-template #elseBlock>
              <ion-input readonly="true">{{activeCapture.name}}</ion-input>
            </ng-template>
          </ion-col>
          <!--Detail state is editable-->
          <ion-col size="3" class="detailPublicState">
            <div>
              <ion-icon name="eye-off-outline"></ion-icon> /
              <ion-icon name="eye-outline"></ion-icon>
            </div>
          </ion-col>
          <ion-col size="3" class="detailToggle">
            <div *ngIf="editable;else elseBlockToggle">
              <ion-toggle
                formControlName="publicToggleEditable"
                color="tertiary"
                [checked]="activeCapture.publicState"
                [(ngModel)]="activeCapture.publicState"
                disabled="false"
              ></ion-toggle>
            </div>
            <ng-template #elseBlockToggle>
              <ion-toggle
                color="tertiary"
                [checked]="activeCapture.publicState"
                disabled="true"
              ></ion-toggle
            ></ng-template>
          </ion-col>
          <ion-col size="1">
            <div *ngIf="activeCapture.dislikeChecked; else notCheckedBlock">
              <ion-img
                src="/assets/icon/dislike_black.png"
                class="dislikeImg"
                (click)="checkDislike(activeCapture.idCapture)"
              ></ion-img>
            </div>
            <ng-template #notCheckedBlock>
              <ion-img
                src="/assets/icon/dislike_white.png"
                class="dislikeImg"
                (click)="checkDislike(activeCapture.idCapture)"
              ></ion-img
            ></ng-template>
          </ion-col>
        </ion-row>
        <!--Detail description is editable-->
        <ion-row>
          <ion-col
            style="
              margin-left: 10%;
              margin-right: 10%;
              margin-top: 5%;
              margin-bottom: 10%;
            "
          >
            <div *ngIf="editable; else elseBlockDescription">
              <ion-textarea
                placeholder="Description"
                formControlName="captureDescriptionEditable"
                readonly="false"
                class="detailPageDescription"
                rows="4"
                cols="4"
                position="floating"
                [(ngModel)]="activeCapture.description"
              ></ion-textarea>
            </div>
            <ng-template #elseBlockDescription>
              <ion-textarea
                class="detailPageDescription"
                readonly="true"
                rows="4"
                cols="4"
                position="floating"
                >{{activeCapture.description}}</ion-textarea
              >
            </ng-template>
          </ion-col>
        </ion-row>
        <ion-row>
          <div class="coordinates">
            <ion-col style="margin-left: 18%; text-align: right"
              ><ion-label style="font-style: bold"
                >Latitude:
              </ion-label></ion-col
            >
            <ion-col> {{activeCapture.latitude}}</ion-col>
            <ion-col style="margin-left: 15%; text-align: right">
              <ion-label style="font-style: bold"
                >Longitude:
              </ion-label></ion-col
            >
            <ion-col>{{activeCapture.longitude}}</ion-col>
            <ion-col style="margin-left: 8%">
              <ion-icon
                name="map-outline"
                size="large"
                (click)="goToMap(activeCapture.idCapture)"
              ></ion-icon
            ></ion-col>
          </div>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-button class="detailButtonEdit" (click)="editCapture()"
              >Edit</ion-button
            >
          </ion-col>
          <ion-col>
            <ion-button class="detailButtonSave" (click)="saveActiveCapture()"
              >Save</ion-button
            >
          </ion-col>
          <ion-col>
            <ion-icon
              name="trash-outline"
              class="detailButtonDelete"
              (click)="callConfirm(activeCapture.idCapture)"
              >Delete</ion-icon
            >
          </ion-col>
        </ion-row>
      </ion-col>
    </form>
  </ion-content>
</ion-app>
